# 9장

## 책의 프로젝트를 시작하기 전 리팩토링하기

### 1.로컬 개발 환경에 톰캣 서버를 시작하면 서블릿 컨테이너의 초기화 과정이 진행된다. 현재 소스코드에서 초기화되는 과정에 대해 설명하라

> **HINT** DB 초기화를 담당하는 `ContextLoaderListner` 클래스와 `URL` 매핑 초기화를 담당하는 `DispatchServlet`클래스부터 분석을 시작한다.

tomcat -> await 전까지 개발자가 설정한 포드, 기본 경로의 값들이 설정된다.
이후에

### 2.

### 3. 질문하기 기능 구현 (구현완료)

#### 요구사항

- [ ] 질문하기를 성공한 후 질문 목록 페이지로 이동한다.

### 4. 로그인하지 않은 사용자도 질문하기가 가능하다. 로그인한 사용자만 질문이 가능하도록 수정 (구현완료)

### 6. 자바 기반으로 웹 프로그래밍을 할 경우 한글이 깨진다. 한글이 꺠지는 문제를 해결하기 위해 serveltFilter를 활용해 문제를 해결할 수 있다.   (애초에 가능했는데?)

### 7. next.web.qna 패키지의 `ShowController`는 멀티스레드 상황에서 문제가 발생할 가능성이 있는 코드이다. 멀티스레드 상황에서 문제가 발생하지 않도록 수정한다. 멀티스레드에서 문제가 되는 이유르를 README.md에 작성한다.

### 8. 상세보기 화면에서 답벼ㅑㄴ하기 기능은 정상적으로 동작한다. 단 답변을 추가할 경우 댓글의 수가 증가하지 않는다. 답변을 추가하는 시점에 질문의 댓글 수도 1 증가해야 한다. 데이터베리스 접근 로직은 직저접 구현해야한다.

### 9. 이 Q&A 서비스는 모바일에서도 서비스할 계획이라 api를 추가해야할 계획이라 API를 추가해야한다. API는 JSON형식으로 제공할 계획이다. /ap/qna/lis URL로 접근했을ㄷ 때 질문 목록을 JSON 데이터로 조회할 수 있도록 구현한다.

### 10. 상세보기 화면의 답변 목록에서 답변을 삭제해야 한다. 답변 삭제 또한 화면을 깜빡이지 않고 구현이 가능하도록 AJAX로 구현한다.

### 11. 질문 수정이 가능해야 한다. 질문 수정은 글쓴이와 로그인 사용자가 같은 경우에만 수정이 가능하다.

### 12. 컨트롤러에서 접근하는 `QuestionDAO`와 `AnswerDAO`와 같이 DAO에서 데이터베이스 접근 로직을 구현할 때 사용하는 `JdbcTemplate`은 인스턴스를 여러 개 생성할 필요없다. 인스턴스를 하나만 생성하도록 구현한다.

### 13. 질문 삭제 기능을 기능을 구현한다. 질문 삭제가 가능한 경우는 다음과 같다. "답변이 없는 경우 질문 삭제가 가능하다". 질문자와 답변자가 모두 같은 경우 질문 삭제가 가능하다. 질문자와 답변자가 다른 답변이 하나라도 있으면 질문을 삭제할 수 없다". 이 질문 삭제 기능은 웹과 모바일 앱에서 모두 지원하려고 한다. 웹 프라우저를 통해 접근했을 때는 `jspView`를 활용해 목록 페이지로 이동하고 모바일 앱을 지원하기 위해 `JsonView`를 활용해 응답 결과를 `Json`으로 전송하려고 한다. 이를 지원하려면 두 개의 컨트롤러가 필요하다. 각 컨트롤러를 구현해보면 많은 중복이 발생한다. 각 컨트롤러에서 발생하는 중복을 제거한다.



